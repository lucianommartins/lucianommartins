name: Terminal GIF

on:
  # Run weekly on Sundays at midnight
  schedule:
    - cron: "0 0 * * 0"
  # Allow manual runs from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install github-readme-terminal
      
      - name: Generate Terminal GIF
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          # Create config for the terminal
          cat > config.toml << 'EOF'
          [github]
          username = "lucianommartins"

          [terminal]
          # Color scheme - options: ubuntu, hacker, atom, dracula, gruvbox, monokai, one-dark
          theme = "dracula"
          # Show typing effect
          typing_effect = true
          # Typing speed (lower = faster)
          typing_speed = 50
          # Boot sequence simulation
          show_boot = true
          # Width in characters
          width = 80
          # Height in characters  
          height = 24

          [display]
          # Stats to show
          show_username = true
          show_bio = true
          show_location = true
          show_company = true
          show_repos = true
          show_followers = true
          show_following = true
          show_stars = true
          show_languages = true
          show_contributions = true
          EOF
          
          # Generate the GIF
          github-readme-terminal --config config.toml --output terminal.gif || echo "Using fallback method"
      
      - name: Fallback - Use simpler approach
        if: failure()
        run: |
          # If the main tool fails, create a placeholder
          echo "Terminal GIF generation requires manual setup - see README"
      
      - name: Commit and push
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add terminal.gif 2>/dev/null || true
          git diff --quiet && git diff --staged --quiet || git commit -m "chore: update terminal GIF"
          git push || true
